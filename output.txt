        ┌───┐  ┌───────────────┐                              »
   q_0: ┤ H ├──┤ Rz(gammas[0]) ├─────■─────────────────────■──»
        ├───┤┌─┴───────────────┴──┐┌─┴─┐┌───────────────┐┌─┴─┐»
   q_1: ┤ H ├┤ Rz(-1.0*gammas[0]) ├┤ X ├┤ Rz(gammas[0]) ├┤ X ├»
        ├───┤└─┬───────────────┬──┘└───┘└───────────────┘└───┘»
   q_2: ┤ H ├──┤ Rz(gammas[0]) ├──────────────────────────────»
        ├───┤┌─┴───────────────┴──┐                           »
   q_3: ┤ H ├┤ Rz(-1.0*gammas[0]) ├───────────────────────────»
        └───┘└────────────────────┘                           »
meas: 4/══════════════════════════════════════════════════════»
                                                              »
«        ┌────────────────────┐                           »
«   q_0: ┤ Rz(-1.0*gammas[0]) ├──■─────────────────────■──»
«        └─┬───────────────┬──┘┌─┴─┐┌───────────────┐┌─┴─┐»
«   q_1: ──┤ Rz(gammas[0]) ├───┤ X ├┤ Rz(gammas[0]) ├┤ X ├»
«          └───────────────┘   └───┘└───────────────┘└───┘»
«   q_2: ─────────────────────────────────────────────────»
«                                                         »
«   q_3: ─────────────────────────────────────────────────»
«                                                         »
«meas: 4/═════════════════════════════════════════════════»
«                                                         »
«        ┌────────────────────┐                           »
«   q_0: ┤ Rz(-1.0*gammas[0]) ├───────────────────────────»
«        ├────────────────────┤                           »
«   q_1: ┤ Rz(-1.0*gammas[0]) ├──■─────────────────────■──»
«        └────────────────────┘┌─┴─┐┌───────────────┐┌─┴─┐»
«   q_2: ──────────────────────┤ X ├┤ Rz(gammas[0]) ├┤ X ├»
«                              └───┘└───────────────┘└───┘»
«   q_3: ─────────────────────────────────────────────────»
«                                                         »
«meas: 4/═════════════════════════════════════════════════»
«                                                         »
«                                                                          »
«   q_0: ──────────────────────────────────────────────────────────────────»
«          ┌───────────────┐                                               »
«   q_1: ──┤ Rz(gammas[0]) ├─────■─────────────────────■───────────────────»
«        ┌─┴───────────────┴──┐┌─┴─┐┌───────────────┐┌─┴─┐┌───────────────┐»
«   q_2: ┤ Rz(-1.0*gammas[0]) ├┤ X ├┤ Rz(gammas[0]) ├┤ X ├┤ Rz(gammas[0]) ├»
«        └────────────────────┘└───┘└───────────────┘└───┘└───────────────┘»
«   q_3: ──────────────────────────────────────────────────────────────────»
«                                                                          »
«meas: 4/══════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                              »
«   q_0: ──────────────────────────────────────────────────────»
«                                                              »
«   q_1: ──────────────────────────────────────────────────────»
«                                   ┌────────────────────┐     »
«   q_2: ──■─────────────────────■──┤ Rz(-1.0*gammas[0]) ├──■──»
«        ┌─┴─┐┌───────────────┐┌─┴─┐└─┬───────────────┬──┘┌─┴─┐»
«   q_3: ┤ X ├┤ Rz(gammas[0]) ├┤ X ├──┤ Rz(gammas[0]) ├───┤ X ├»
«        └───┘└───────────────┘└───┘  └───────────────┘   └───┘»
«meas: 4/══════════════════════════════════════════════════════»
«                                                              »
«                                                                          »
«   q_0: ─────────────────────────────────────────■─────────────────────■──»
«                                                 │                     │  »
«   q_1: ─────────────────────────────────────────┼─────────────────────┼──»
«                                                 │                     │  »
«   q_2: ───────────────────■─────────────────────┼─────────────────────┼──»
«        ┌───────────────┐┌─┴─┐┌───────────────┐┌─┴─┐┌───────────────┐┌─┴─┐»
«   q_3: ┤ Rz(gammas[0]) ├┤ X ├┤ Rz(gammas[0]) ├┤ X ├┤ Rz(gammas[0]) ├┤ X ├»
«        └───────────────┘└───┘└───────────────┘└───┘└───────────────┘└───┘»
«meas: 4/══════════════════════════════════════════════════════════════════»
«                                                                          »
«          ┌───────────────┐                               ░ ┌────────────────┐»
«   q_0: ──┤ Rz(gammas[0]) ├─────■─────────────────────■───░─┤ Rx(2*betas[0]) ├»
«          └───────────────┘     │                     │   ░ ├────────────────┤»
«   q_1: ────────────────────────┼─────────────────────┼───░─┤ Rx(2*betas[0]) ├»
«                                │                     │   ░ ├────────────────┤»
«   q_2: ────────────────────────┼─────────────────────┼───░─┤ Rx(2*betas[0]) ├»
«        ┌────────────────────┐┌─┴─┐┌───────────────┐┌─┴─┐ ░ ├────────────────┤»
«   q_3: ┤ Rz(-1.0*gammas[0]) ├┤ X ├┤ Rz(gammas[0]) ├┤ X ├─░─┤ Rx(2*betas[0]) ├»
«        └────────────────────┘└───┘└───────────────┘└───┘ ░ └────────────────┘»
«meas: 4/══════════════════════════════════════════════════════════════════════»
«                                                                              »
«          ┌───────────────┐                              »
«   q_0: ──┤ Rz(gammas[1]) ├─────■─────────────────────■──»
«        ┌─┴───────────────┴──┐┌─┴─┐┌───────────────┐┌─┴─┐»
«   q_1: ┤ Rz(-1.0*gammas[1]) ├┤ X ├┤ Rz(gammas[1]) ├┤ X ├»
«        └─┬───────────────┬──┘└───┘└───────────────┘└───┘»
«   q_2: ──┤ Rz(gammas[1]) ├──────────────────────────────»
«        ┌─┴───────────────┴──┐                           »
«   q_3: ┤ Rz(-1.0*gammas[1]) ├───────────────────────────»
«        └────────────────────┘                           »
«meas: 4/═════════════════════════════════════════════════»
«                                                         »
«        ┌────────────────────┐                           »
«   q_0: ┤ Rz(-1.0*gammas[1]) ├──■─────────────────────■──»
«        └─┬───────────────┬──┘┌─┴─┐┌───────────────┐┌─┴─┐»
«   q_1: ──┤ Rz(gammas[1]) ├───┤ X ├┤ Rz(gammas[1]) ├┤ X ├»
«          └───────────────┘   └───┘└───────────────┘└───┘»
«   q_2: ─────────────────────────────────────────────────»
«                                                         »
«   q_3: ─────────────────────────────────────────────────»
«                                                         »
«meas: 4/═════════════════════════════════════════════════»
«                                                         »
«        ┌────────────────────┐                           »
«   q_0: ┤ Rz(-1.0*gammas[1]) ├───────────────────────────»
«        ├────────────────────┤                           »
«   q_1: ┤ Rz(-1.0*gammas[1]) ├──■─────────────────────■──»
«        └────────────────────┘┌─┴─┐┌───────────────┐┌─┴─┐»
«   q_2: ──────────────────────┤ X ├┤ Rz(gammas[1]) ├┤ X ├»
«                              └───┘└───────────────┘└───┘»
«   q_3: ─────────────────────────────────────────────────»
«                                                         »
«meas: 4/═════════════════════════════════════════════════»
«                                                         »
«                                                                          »
«   q_0: ──────────────────────────────────────────────────────────────────»
«          ┌───────────────┐                                               »
«   q_1: ──┤ Rz(gammas[1]) ├─────■─────────────────────■───────────────────»
«        ┌─┴───────────────┴──┐┌─┴─┐┌───────────────┐┌─┴─┐┌───────────────┐»
«   q_2: ┤ Rz(-1.0*gammas[1]) ├┤ X ├┤ Rz(gammas[1]) ├┤ X ├┤ Rz(gammas[1]) ├»
«        └────────────────────┘└───┘└───────────────┘└───┘└───────────────┘»
«   q_3: ──────────────────────────────────────────────────────────────────»
«                                                                          »
«meas: 4/══════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                              »
«   q_0: ──────────────────────────────────────────────────────»
«                                                              »
«   q_1: ──────────────────────────────────────────────────────»
«                                   ┌────────────────────┐     »
«   q_2: ──■─────────────────────■──┤ Rz(-1.0*gammas[1]) ├──■──»
«        ┌─┴─┐┌───────────────┐┌─┴─┐└─┬───────────────┬──┘┌─┴─┐»
«   q_3: ┤ X ├┤ Rz(gammas[1]) ├┤ X ├──┤ Rz(gammas[1]) ├───┤ X ├»
«        └───┘└───────────────┘└───┘  └───────────────┘   └───┘»
«meas: 4/══════════════════════════════════════════════════════»
«                                                              »
«                                                                          »
«   q_0: ─────────────────────────────────────────■─────────────────────■──»
«                                                 │                     │  »
«   q_1: ─────────────────────────────────────────┼─────────────────────┼──»
«                                                 │                     │  »
«   q_2: ───────────────────■─────────────────────┼─────────────────────┼──»
«        ┌───────────────┐┌─┴─┐┌───────────────┐┌─┴─┐┌───────────────┐┌─┴─┐»
«   q_3: ┤ Rz(gammas[1]) ├┤ X ├┤ Rz(gammas[1]) ├┤ X ├┤ Rz(gammas[1]) ├┤ X ├»
«        └───────────────┘└───┘└───────────────┘└───┘└───────────────┘└───┘»
«meas: 4/══════════════════════════════════════════════════════════════════»
«                                                                          »
«          ┌───────────────┐                               ░ ┌────────────────┐»
«   q_0: ──┤ Rz(gammas[1]) ├─────■─────────────────────■───░─┤ Rx(2*betas[1]) ├»
«          └───────────────┘     │                     │   ░ ├────────────────┤»
«   q_1: ────────────────────────┼─────────────────────┼───░─┤ Rx(2*betas[1]) ├»
«                                │                     │   ░ ├────────────────┤»
«   q_2: ────────────────────────┼─────────────────────┼───░─┤ Rx(2*betas[1]) ├»
«        ┌────────────────────┐┌─┴─┐┌───────────────┐┌─┴─┐ ░ ├────────────────┤»
«   q_3: ┤ Rz(-1.0*gammas[1]) ├┤ X ├┤ Rz(gammas[1]) ├┤ X ├─░─┤ Rx(2*betas[1]) ├»
«        └────────────────────┘└───┘└───────────────┘└───┘ ░ └────────────────┘»
«meas: 4/══════════════════════════════════════════════════════════════════════»
«                                                                              »
«         ░ ┌─┐         
«   q_0: ─░─┤M├─────────
«         ░ └╥┘┌─┐      
«   q_1: ─░──╫─┤M├──────
«         ░  ║ └╥┘┌─┐   
«   q_2: ─░──╫──╫─┤M├───
«         ░  ║  ║ └╥┘┌─┐
«   q_3: ─░──╫──╫──╫─┤M├
«         ░  ║  ║  ║ └╥┘
«meas: 4/════╩══╩══╩══╩═
«            0  1  2  3